extends ./layouts/_layout.jade

block content
  h1= title
  h3 Whatâ€™s in your quiver?
  p quiver (<em>kwiv-er</em>) n. - a collection of surfboards in different shapes, lengths and thicknesses
  form#board-check
    span.error
    .fieldset
      input#bb(type="checkbox" data-boardType="BB")
      label(for="bb") Boogie board
    .fieldset
      input#sb(type="checkbox" data-boardType="SB")
      label(for="sb") Shortboard
    .fieldset
      input#lb(type="checkbox" data-boardType="LB")
      label(for="lb") Longboard
    .fieldset
      input#sup(type="checkbox" data-boardType="SUP")
      label(for="sup") Stand-up Paddle board
  a#submit(href="/skill") Next

  script.
    // SET COOKIE
    var formSubmit = document.querySelector('#submit');
    var boardInputs = document.querySelectorAll('[data-boardType]');
    formSubmit.addEventListener('click', function(e) {
      var boardsSelected       = [],
          boardsSelectedBinary = [];
        for (var i = 0; i < boardInputs.length; i++) {
          var thisInput = boardInputs[i];
          if (thisInput.checked) {
            boardsSelected.push(thisInput.getAttribute('data-boardType'));
            boardsSelectedBinary.push("1");
          } else {
            boardsSelectedBinary.push("0");
          }
        };

        boardsSelectedBinary = boardsSelectedBinary.join("");
        if ( boardsSelectedBinary === "0000" ) {
          e.preventDefault();
          document.querySelector('span.error').innerHTML = "Whoops, you need to have a board to surf. No board? No dice."
        }
        if (cookies.test()) {
          cookies.set('boardsSelected', boardsSelected);

          cookies.set('boardsSelectedBinary', boardsSelectedBinary);
        }
    })

    // GET COOKIE
    if (cookies.get('boardsSelected')) {
      var cookieResult = cookies.get('boardsSelected');
      console.log('boardsSelected cookie exists: [' + cookieResult + ']');
      for (var i = 0; i < cookieResult.length; i++) {
        document.querySelector('[data-boardType="' + cookieResult[i] + '"]').checked = true;
      }
    }